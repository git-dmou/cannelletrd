# creation d'un Module à partir d'un fichier XL + ressources
#
# NON ZIPPE
#
# curl 'https://prt-dmou/thaleia/api/v1/transform?type=cannelle_import&locale=fr'
#  -H 'Accept: */*'
#  -H 'Accept-Language: fr-FR,fr;q=0.9'
#  -H 'Authorization: vxCbxhLr8uYhG9rpnFt1gcoRTfY7nA8u'
#  -H 'Connection: keep-alive'
#  -H 'Content-Type: application/json'
#  -H 'Cookie: anonid=fd6c01bdf132; LoggedIn=BR_JYBUaPUz1KY7t9JVxe2SXaOLayPam; JSESSIONID=EFE1544E8543B94CB8AFC98D4BA12C1D; thaleia-cannelle-createContent-alreadyViewedPage-https://prt-dmou/thaleia/=true; thaleia-cannelle-createContent-workingTempdirhttps://prt-dmou/thaleia/=https://prt-dmou/thaleia/api/v1/tempdirs/f43284b2b8a348a282f14b0425dc30d7; cookieconsent_dismissed=yes'
#  -H 'Origin: https://prt-dmou'
#  -H 'Referer: https://prt-dmou/thaleia/home?5'
#  -H 'Sec-Fetch-Dest: empty'
#  -H 'Sec-Fetch-Mode: cors'
#  -H 'Sec-Fetch-Site: same-origin'
#  -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36'
#  -H 'sec-ch-ua: "Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"'
#  -H 'sec-ch-ua-mobile: ?0'
#  -H 'sec-ch-ua-platform: "Windows"'
#  --data-raw '{"type":"http_download","url":"https://prt-dmou/thaleia/api/v1/tempdirs/f43284b2b8a348a282f14b0425dc30d7/export?format=zip","headers":[{"name":"Authorization","value":"vxCbxhLr8uYhG9rpnFt1gcoRTfY7nA8u"}]}'
POST https://prt-dmou/thaleia/api/v1/transform?type=cannelle_import&locale=fr
Accept: */*
Accept-Language: fr-FR,fr;q=0.9
Authorization: vxCbxhLr8uYhG9rpnFt1gcoRTfY7nA8u
user: admin
Connection: keep-alive
Cookie: anonid=fd6c01bdf132; LoggedIn=BR_JYBUaPUz1KY7t9JVxe2SXaOLayPam; JSESSIONID=EFE1544E8543B94CB8AFC98D4BA12C1D; thaleia-cannelle-createContent-alreadyViewedPage-https://prt-dmou/thaleia/=true; thaleia-cannelle-createContent-workingTempdirhttps://prt-dmou/thaleia/=https://prt-dmou/thaleia/api/v1/tempdirs/f43284b2b8a348a282f14b0425dc30d7; cookieconsent_dismissed=yes
Origin: https://prt-dmou
Referer: https://prt-dmou/thaleia/home?5
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
sec-ch-ua: "Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Content-Type: application/json

{"type":"http_download","url":"https://prt-dmou/thaleia/api/v1/tempdirs/f43284b2b8a348a282f14b0425dc30d7/export?format=zip","headers":[{"name":"Authorization","value":"vxCbxhLr8uYhG9rpnFt1gcoRTfY7nA8u"}]}

####
# traduction d'un module à partir d'un fichier XL + ressources
#
# NON ZIP en entree !
#
# -> utiliser un token valide (header et json)
# -> mettre le contenu à généré dans un "dossier temporaire" qui correspond à l'identifiant public dans l'url
#    dans le corps de la requête
#
# le dossier transmis est ensuite "exporté" au format zip, avant d'être traité
# ce n'est le comportement attendu car :
# - les ressources des version_content sont dans des localizedFile sous forme fdgcsdg.tmp --> = zip
# - voir pour jouer sur export?format=zip / ou autre ?
# ATTENTION, comme on dois utiliser un fichier temp, il faudrait décompresser le zip dans un fichier temp avant de faire la requête !
POST https://prt-dmou/thaleia/api/v1/transform?type=cannelle_translate_module&locale=fr&translatefrom=FR&to=EN
Accept: */*
Accept-Language: fr-FR,fr;q=0.9
Authorization: 6Ozn3l8xbR9uDr5iunCL1NE6dEYN0SkM
user: admin
Connection: keep-alive
#Cookie: anonid=fd6c01bdf132; LoggedIn=BR_JYBUaPUz1KY7t9JVxe2SXaOLayPam; JSESSIONID=EFE1544E8543B94CB8AFC98D4BA12C1D; thaleia-cannelle-createContent-alreadyViewedPage-https://prt-dmou/thaleia/=true; thaleia-cannelle-createContent-workingTempdirhttps://prt-dmou/thaleia/=https://prt-dmou/thaleia/api/v1/tempdirs/f43284b2b8a348a282f14b0425dc30d7; cookieconsent_dismissed=yes
Origin: https://prt-dmou
Referer: https://prt-dmou/thaleia/home?5
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36
sec-ch-ua: "Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Content-Type: application/json

{"type":"http_download","url":"https://prt-dmou/thaleia/api/v1/tempdirs/4e76fe5a78dc47c5b6b4fce27985d099/export?format=zip","headers":[{"name":"Authorization","value":"6Ozn3l8xbR9uDr5iunCL1NE6dEYN0SkM"}]}

######
#{"type":"http_download","url":"https://prt-dmou/thaleia/api/v1/tempdirs/129c1d76fdca42dab36a841346bd5068/export?format=zip","headers":[{"name":"Authorization","value":"vxCbxhLr8uYhG9rpnFt1gcoRTfY7nA8u"}]}


#######
# traduction d'un module avec fichier
#
# ZIP en entree !
#
# le fichier ZIP est inclu dans le corps de la requête !!!
# des délimiteurs sont utilisés pour contenir le fichier "binaire" !
#
# Pb de copier-coller de la requête Curl en reequête HTTP !

curl "https://thaleiaxl.solunea.net/thaleia/api/v1/transform?type=cannelle_import&locale=fr" -X POST -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0" -H "Accept: */*" -H "Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3" -H "Accept-Encoding: gzip, deflate, br" -H "Authorization: kQFsYGzJgcXXnz6QploJh0Eiisqqizay" -H "Content-Type: multipart/form-data; boundary=---------------------------163479680630416650292648820300" -H "Origin: https://thaleiaxl.solunea.net" -H "DNT: 1" -H "Connection: keep-alive" -H "Referer: https://thaleiaxl.solunea.net/thaleia/home" -H "Cookie: anonid=e40defcab0de; LoggedIn=BR_JYBUaPUz1KY7t9JVxe2SXaOLayPam; JSESSIONID=0D2DDEEF8E44B434437E044D549C447C.worker1; thaleia-cannelle-createContent-alreadyViewedPage-https://thaleiaxl.solunea.net/thaleia/=true; thaleia-cannelle-createContent-workingTempdirhttps://thaleiaxl.solunea.net/thaleia/=https://thaleiaxl.solunea.net/thaleia/api/v1/tempdirs/c162e826500840e48f9f56f9637cb6a8; cookieconsent_dismissed=yes" -H "Sec-Fetch-Dest: empty" -H "Sec-Fetch-Mode: cors" -H "Sec-Fetch-Site: same-origin" --data-binary "-----------------------------163479680630416650292648820300"^

"Content-Disposition: form-data; name=""first""; filename=""Thaleia_XL_demo.zip"""^

"Content-Type: application/x-zip-compressed"^

""^

"-----------------------------163479680630416650292648820300--"^

""